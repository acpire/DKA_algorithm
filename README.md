# DKA_algorithm

Задача 1. Изоморфизм ДКА Имя входного файла: isomorphism.in Имя выходного файла: isomorphism.out Ограничение по времени: 2 секунды Ограничение по памяти: 64 мегабайта Задано два детерминированных конечных автомата. Определить, изоморфны ли они друг другу. Гарантируется, что все состояния автоматов достижимы. Формат входного файла Во входном файле находятся два описания ДКА. Формат описания следующий: Во первой строке описания содержатся числа n, m и k — количество состояний, переходов и допускающих состояний в автомате соответственно. (1 6 n, m 6 100000, 1 6 k 6 n). В следующей строке содержатся k чисел — номера допускающих состояний (состояния прону- мерованы от 1 до n). В следующих m строках описываются переходы в формате “a b c”, где a — номер исходного состояния перехода, b — номер состояния, в которое осуществляется переход и c — символ (строчная латинская буква), по которому осуществляется переход. Стартовое состояние автомата всегда имеет номер 1. Гарантируется, что из любого состояния не более одного перехода по каждому символу.

Input

3 3 1

3

1 2 a

1 3 c

2 3 b

3 3 1

2

1 3 a

1 2 c

3 2 b

Output

2 0 1

0 2 1

1 1 2

2 1 0

1 2 1

0 1 2

1

0 2 1

Задача 2. Эквивалентность ДКА Имя входного файла: equivalence.in Имя выходного файла: equivalence.out Ограничение по времени: 2 секунды Ограничение по памяти: 64 мегабайта Задано два детерминированных конечных автомата. Определить, эквивалентны ли они друг другу. Формат входного файла Во входном файле находятся два описания ДКА. Формат описания следующий: Во первой строке описания содержатся числа n, m и k — количество состояний, переходов и допускающих состояний в автомате соответственно. (1 6 n, m 6 1000, 1 6 k 6 n). В следующей строке содержатся k чисел — номера допускающих состояний (состояния прону- мерованы от 1 до n). В следующих m строках описываются переходы в формате “a b c”, где a — номер исходного состояния перехода, b — номер состояния, в которое осуществляется переход и c — символ (строчная латинская буква), по которому осуществляется переход. Стартовое состояние автомата всегда имеет номер 1. Гарантируется, что из любого состояния не более одного перехода по каждому символу.

Input

1 1 1

1

1 1 a

2 2 2

1 2

1 2 a

2 2 a

Output

1

Задача 4. Быстрая минимизация ДКА Имя входного файла: fastminimization.in Имя выходного файла: fastminimization.out Ограничение по времени: 2 секунды Ограничение по памяти: 64 мегабайта Задан детерминированный конечный автомат. Требуется построить эквивалентный ему автомат с минимальным количеством состояний. Формат входного файла Во первой строке входного файла содержатся числа n, m и k — количество состояний, переходов и допускающих состояний в автомате соответственно. (1 6 n, m 6 50000, 1 6 k 6 n). В следующей строке содержатся k чисел — номера допускающих состояний (состояния прону- мерованы от 1 до n). В следующих m строках описываются переходы в формате “a b c”, где a — номер исходного состояния перехода, b — номер состояния, в которое осуществляется переход и c — символ (строчная латинская буква), по которому осуществляется переход. Стартовое состояние автомата всегда имеет номер 1. Гарантируется, что из любого состояния не более одного перехода по каждому символу.

Input

8 16 2

6 7

1 2 b

1 8 a

2 1 b

2 8 a

8 3 a

8 3 b

3 5 a

3 6 b

4 5 a

4 6 b

5 6 a

5 7 b

6 6 a

6 6 b

7 6 b

7 7 a

Output

5 10 1

5

1 1 b

1 4 a

2 5 a

2 5 b

3 2 a

3 5 b

4 3 a

4 3 b

5 5 a

5 5 b
